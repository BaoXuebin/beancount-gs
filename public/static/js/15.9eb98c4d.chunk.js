(this["webpackJsonpbeancount-web"]=this["webpackJsonpbeancount-web"]||[]).push([[15],{472:function(t,e,n){"use strict";n.r(e);var i=n(12),o=n(13),r=n(15),a=n(14),c=n(480),s=n(463),l=n(135),u=n(271),h=n(357),d=(n(452),n(0)),f=n(59),b=n(16),p=n(70),m=n(1),j=function(t){Object(r.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(i.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).theme=t.context.theme,t.state={loading:!1,path:null,files:[],rawContent:"",content:"",editorState:h.EditorState.createEmpty()},t.fetchFileDir=function(){t.setState({loading:!0}),Object(f.b)("/api/auth/file/dir").then((function(e){t.setState({files:e})})).finally((function(){t.setState({loading:!1})}))},t.handldEditContent=function(e){t.setState({editorState:e,content:e.getCurrentContent().getPlainText()})},t.handleChangeFile=function(e){t.setState({path:e},(function(){t.fetchFileContent(e)}))},t.fetchFileContent=function(){t.setState({loading:!0}),Object(f.b)("/api/auth/file/content?path=".concat(t.state.path)).then((function(e){t.setState({rawContent:e,content:e,editorState:h.EditorState.createWithContent(h.ContentState.createFromText(e))})})).finally((function(){t.setState({loading:!1})}))},t.saveFileContent=function(){var e=t.state,n=e.path,i=e.content;t.setState({loading:!0}),Object(f.b)("/api/auth/file",{method:"POST",body:{path:n,content:i}}).then((function(){t.setState({rawContent:i}),s.b.success("\u4fdd\u5b58\u6210\u529f")})).finally((function(){t.setState({loading:!1})}))},t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.fetchFileDir()}},{key:"render",value:function(){return this.context.theme!==this.theme&&(this.theme=this.context.theme),Object(m.jsxs)("div",{className:"edit-page",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(l.a,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6e90\u6587\u4ef6",style:{width:"200px"},onChange:this.handleChangeFile,children:this.state.files.map((function(t){return Object(m.jsx)(l.a.Option,{value:t,children:t},t)}))}),"\xa0\xa0",Object(m.jsx)(u.a,{type:"primary",icon:Object(m.jsx)(c.a,{}),disabled:this.state.rawContent===this.state.content,loading:this.state.loading,onClick:this.saveFileContent,children:"\u4fdd\u5b58"})]}),Object(m.jsx)("div",{style:{marginTop:"1rem"},children:Object(m.jsx)(h.Editor,{placeholder:"\u672a\u9009\u62e9\u6587\u4ef6",editorState:this.state.editorState,onChange:this.handldEditContent})})]})}}]),n}(d.Component);j.contextType=b.a,e.default=Object(p.a)(j)},59:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"f",(function(){return b}));var i=n(463),o=n(73),r=n.n(o),a=n(112),c=n.n(a),s=function(t){var e=t.split(":");return e&&e.length>=1?t.split(":")[0]:""},l=function(t){return t.split(":").join("_")},u=function(t){var e=t.split(":");return e&&e.length>=2?t.split(":")[e.length-1]:""},h={Income:"\u6536\u5165",Expenses:"\u652f\u51fa",Liabilities:"\u8d1f\u503a",Assets:"\u8d44\u4ea7"},d=function(t){return t},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.method,o=e.headers,r=e.body,a={"Content-Type":"application/json",ledgerId:window.localStorage.getItem("ledgerId")};return new Promise((function(e,s){c()(t,{method:n,headers:Object.assign({},a,o),body:JSON.stringify(r)}).then(d).then((function(t){return t.json()})).then((function(t){var n=t.code;200===n?e(t.data):200!==n&&(400===n?i.b.error("\u8bf7\u6c42\u53c2\u6570\u9519\u8bef"):1001===n?i.b.error("\u8d26\u76ee\u4e0d\u5e73\u8861"):1003===n?i.b.error("\u65e0\u6548\u8d26\u6237"):1005===n?i.b.error("\u65e0\u6548\u547d\u4ee4"):1006===n?i.b.error("\u5bc6\u7801\u9519\u8bef"):1007===n?i.b.error("\u8d26\u6237\u5df2\u5b58\u5728"):1010===n||401===n?window.location.href="/web/#/ledger":i.b.error("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"),s(t))})).catch((function(t){i.b.error("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"),s(t)}))}))},b=function(){return r()().format("YYYY-M")}},70:function(t,e,n){"use strict";var i=n(61),o=n(12),r=n(13),a=n(15),c=n(14),s=n(0),l=n(1);e.a=function(t){return function(e){Object(a.a)(s,e);var n=Object(c.a)(s);function s(){var t;Object(o.a)(this,s);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return(t=n.call.apply(n,[this].concat(i))).defaultCommodity={currency:"CNY",symbol:"\uffe5"},t.currentCommodity=window.localStorage.getItem("ledgerCurrency"),t}return Object(r.a)(s,[{key:"render",value:function(){return Object(l.jsx)(t,Object(i.a)(Object(i.a)({},this.props),{},{commodity:this.currentCommodity?JSON.parse(this.currentCommodity):this.defaultCommodity}))}}]),s}(s.Component)}}}]);
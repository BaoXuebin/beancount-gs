(this["webpackJsonpbeancount-web"]=this["webpackJsonpbeancount-web"]||[]).push([[13],{188:function(e,t,n){"use strict";var a=n(0),c=n(5);t.a=e=>class extends a.Component{constructor(){super(...arguments),this.defaultCommodity={currency:"CNY",symbol:"\uffe5"},this.currentCommodity=window.localStorage.getItem("ledgerCurrency")}render(){return Object(c.jsx)(e,{...this.props,commodity:this.currentCommodity?JSON.parse(this.currentCommodity):this.defaultCommodity})}}},189:function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},197:function(e,t,n){var a=n(208),c=n(189),r=n(132),i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(r(e))return NaN;if(c(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=c(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=a(e);var n=o.test(e);return n||s.test(e)?l(e.slice(2),n?2:8):i.test(e)?NaN:+e}},206:function(e,t,n){var a=n(189),c=n(207),r=n(197),i=Math.max,o=Math.min;e.exports=function(e,t,n){var s,l,u,d,m,f,p=0,b=!1,h=!1,j=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function O(t){var n=s,a=l;return s=l=void 0,p=t,d=e.apply(a,n)}function v(e){var n=e-f;return void 0===f||n>=t||n<0||h&&e-p>=u}function y(){var e=c();if(v(e))return x(e);m=setTimeout(y,function(e){var n=t-(e-f);return h?o(n,u-(e-p)):n}(e))}function x(e){return m=void 0,j&&s?O(e):(s=l=void 0,d)}function g(){var e=c(),n=v(e);if(s=arguments,l=this,f=e,n){if(void 0===m)return function(e){return p=e,m=setTimeout(y,t),b?O(e):d}(f);if(h)return clearTimeout(m),m=setTimeout(y,t),O(f)}return void 0===m&&(m=setTimeout(y,t)),d}return t=r(t)||0,a(n)&&(b=!!n.leading,u=(h="maxWait"in n)?i(r(n.maxWait)||0,t):u,j="trailing"in n?!!n.trailing:j),g.cancel=function(){void 0!==m&&clearTimeout(m),p=0,s=f=l=m=void 0},g.flush=function(){return void 0===m?d:x(c())},g}},207:function(e,t,n){var a=n(131);e.exports=function(){return a.Date.now()}},208:function(e,t,n){var a=n(209),c=/^\s+/;e.exports=function(e){return e?e.slice(0,a(e)+1).replace(c,""):e}},209:function(e,t){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},217:function(e,t,n){"use strict";var a=n(3),c=n(1),r=n(4),i=n(10),o=n.n(i),s=n(206),l=n.n(s),u=n(68),d=n(0),m=n(42),f=n(56),p=n(47),b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(e);c<a.length;c++)t.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(e,a[c])&&(n[a[c]]=e[a[c]])}return n},h=(Object(p.a)("small","default","large"),null);var j=function(e){var t=e.spinPrefixCls,n=e.spinning,i=void 0===n||n,s=e.delay,p=e.className,j=e.size,O=void 0===j?"default":j,v=e.tip,y=e.wrapperClassName,x=e.style,g=e.children,C=b(e,["spinPrefixCls","spinning","delay","className","size","tip","wrapperClassName","style","children"]),N=d.useState((function(){return i&&!function(e,t){return!!e&&!!t&&!isNaN(Number(t))}(i,s)})),E=Object(r.a)(N,2),w=E[0],k=E[1];d.useEffect((function(){var e=l()((function(){k(i)}),s);return e(),function(){var t;null===(t=null===e||void 0===e?void 0:e.cancel)||void 0===t||t.call(e)}}),[s,i]);var S=function(n){var r=n.direction,i=o()(t,Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({},"".concat(t,"-sm"),"small"===O),"".concat(t,"-lg"),"large"===O),"".concat(t,"-spinning"),w),"".concat(t,"-show-text"),!!v),"".concat(t,"-rtl"),"rtl"===r),p),s=Object(u.a)(C,["indicator","prefixCls"]),l=d.createElement("div",Object(a.a)({},s,{style:x,className:i,"aria-live":"polite","aria-busy":w}),function(e,t){var n=t.indicator,a="".concat(e,"-dot");return null===n?null:Object(f.c)(n)?Object(f.a)(n,{className:o()(n.props.className,a)}):Object(f.c)(h)?Object(f.a)(h,{className:o()(h.props.className,a)}):d.createElement("span",{className:o()(a,"".concat(e,"-dot-spin"))},d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}))}(t,e),v?d.createElement("div",{className:"".concat(t,"-text")},v):null);if("undefined"!==typeof g){var m=o()("".concat(t,"-container"),Object(c.a)({},"".concat(t,"-blur"),w));return d.createElement("div",Object(a.a)({},s,{className:o()("".concat(t,"-nested-loading"),y)}),w&&d.createElement("div",{key:"loading"},l),d.createElement("div",{className:m,key:"container"},g))}return l};return d.createElement(m.a,null,S)},O=function(e){var t=e.prefixCls,n=(0,d.useContext(m.b).getPrefixCls)("spin",t),c=Object(a.a)(Object(a.a)({},e),{spinPrefixCls:n});return d.createElement(j,Object(a.a)({},c))};O.setDefaultIndicator=function(e){h=e},t.a=O},231:function(e,t,n){"use strict";function a(e){return Object.keys(e).reduce((function(t,n){return!n.startsWith("data-")&&!n.startsWith("aria-")&&"role"!==n||n.startsWith("data-__")||(t[n]=e[n]),t}),{})}n.d(t,"a",(function(){return a}))},448:function(e,t,n){"use strict";var a=n(3),c=n(4),r=n(1),i=n(105),o=n(79),s=n(103),l=n(81),u=n(71),d=n(106),m=n(63),f=n(116),p=n(80),b=n(10),h=n.n(b),j=n(39),O=n(0),v=n(42),y=n(231),x=n(56),g=n(18),C=n(19),N=n(78),E=n(77),w=n(50),k=n(26);var S=function(e){function t(){var e,n,a,c;return Object(g.a)(this,t),n=this,a=t,c=arguments,a=Object(w.a)(a),(e=Object(N.a)(n,Object(E.a)()?Reflect.construct(a,c||[],Object(w.a)(n).constructor):a.apply(n,c))).state={error:void 0,info:{componentStack:""}},e}return Object(k.a)(t,e),Object(C.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.description,a=e.children,c=this.state,r=c.error,i=c.info,o=i&&i.componentStack?i.componentStack:null,s="undefined"===typeof t?(r||"").toString():t,l="undefined"===typeof n?o:n;return r?O.createElement(D,{type:"error",message:s,description:O.createElement("pre",null,l)}):a}}]),t}(O.Component),I=S,T=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(e);c<a.length;c++)t.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(e,a[c])&&(n[a[c]]=e[a[c]])}return n},P={success:i.a,info:f.a,error:s.a,warning:d.a},q={success:o.a,info:p.a,error:l.a,warning:m.a},R=function(e){var t=e.description,n=e.icon,a=e.prefixCls,c=e.type,i=(t?q:P)[c]||null;return n?Object(x.d)(n,O.createElement("span",{className:"".concat(a,"-icon")},n),(function(){return{className:h()("".concat(a,"-icon"),Object(r.a)({},n.props.className,n.props.className))}})):O.createElement(i,{className:"".concat(a,"-icon")})},M=function(e){var t=e.isClosable,n=e.closeText,a=e.prefixCls,c=e.closeIcon,r=e.handleClose;return t?O.createElement("button",{type:"button",onClick:r,className:"".concat(a,"-close-icon"),tabIndex:0},n?O.createElement("span",{className:"".concat(a,"-close-text")},n):c):null},F=function(e){var t=e.description,n=e.prefixCls,i=e.message,o=e.banner,s=e.className,l=void 0===s?"":s,d=e.style,m=e.onMouseEnter,f=e.onMouseLeave,p=e.onClick,b=e.afterClose,x=e.showIcon,g=e.closable,C=e.closeText,N=e.closeIcon,E=void 0===N?O.createElement(u.a,null):N,w=e.action,k=T(e,["description","prefixCls","message","banner","className","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),S=O.useState(!1),I=Object(c.a)(S,2),P=I[0],q=I[1],F=O.useRef(),D=O.useContext(v.b),L=D.getPrefixCls,B=D.direction,V=L("alert",n),W=function(e){var t;q(!0),null===(t=k.onClose)||void 0===t||t.call(k,e)},$=!!C||g,z=function(){var e=k.type;return void 0!==e?e:o?"warning":"info"}(),A=!(!o||void 0!==x)||x,J=h()(V,"".concat(V,"-").concat(z),Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},"".concat(V,"-with-description"),!!t),"".concat(V,"-no-icon"),!A),"".concat(V,"-banner"),!!o),"".concat(V,"-rtl"),"rtl"===B),l),_=Object(y.a)(k);return O.createElement(j.b,{visible:!P,motionName:"".concat(V,"-motion"),motionAppear:!1,motionEnter:!1,onLeaveStart:function(e){return{maxHeight:e.offsetHeight}},onLeaveEnd:b},(function(e){var n=e.className,c=e.style;return O.createElement("div",Object(a.a)({ref:F,"data-show":!P,className:h()(J,n),style:Object(a.a)(Object(a.a)({},d),c),onMouseEnter:m,onMouseLeave:f,onClick:p,role:"alert"},_),A?O.createElement(R,{description:t,icon:k.icon,prefixCls:V,type:z}):null,O.createElement("div",{className:"".concat(V,"-content")},i?O.createElement("div",{className:"".concat(V,"-message")},i):null,t?O.createElement("div",{className:"".concat(V,"-description")},t):null),w?O.createElement("div",{className:"".concat(V,"-action")},w):null,O.createElement(M,{isClosable:!!$,closeText:C,prefixCls:V,closeIcon:E,handleClose:W}))}))};F.ErrorBoundary=I;var D=t.a=F},457:function(e,t,n){"use strict";n.r(t);var a=n(448),c=n(61),r=n(275),i=n(213),o=n(462),s=n(469),l=n(217),u=n(224),d=n(0),m=n.n(d),f=n(91),p=n(73),b=n(188),h=n(5);const j={required:"${label} \u4e0d\u80fd\u4e3a\u7a7a\uff01"};class O extends d.Component{constructor(){super(...arguments),this.formRef=m.a.createRef(),this.state={loading:!1,checkStatus:"loading",showForm:!1,config:{}},this.checkReq=()=>{this.setState({loading:!0}),Object(f.d)("/api/check",{method:"POST"}).then((e=>{this.setState({checkStatus:"ok"})})).catch((()=>{this.setState({checkStatus:"error"})})).finally((()=>{this.setState({loading:!1})}))},this.handleNextStep=()=>{this.setState({loading:!0}),Object(f.d)("/api/config",{method:"GET"}).then((e=>{this.setState({config:e,showForm:!0})})).finally((()=>{this.setState({loading:!1})}))},this.handleReCheck=()=>{this.checkReq()},this.handleSubmitServerConfig=e=>{this.setState({loading:!0}),Object(f.d)("/api/config",{method:"POST",body:e}).then((()=>{this.props.history.replace("/ledger")})).finally((()=>{this.setState({loading:!1})}))}}componentDidMount(){this.checkReq()}render(){return"error"===this.state.checkStatus?Object(h.jsxs)("div",{children:[Object(h.jsx)(a.a,{message:"\u68c0\u6d4b\u5931\u8d25",description:"\u4f9d\u8d56\u672a\u5b89\u88c5\uff0c\u8bf7\u5148\u5b89\u88c5 beancount",type:"error",showIcon:!0}),Object(h.jsx)("div",{style:{marginTop:"1rem"},children:Object(h.jsx)(c.a,{block:!0,type:"danger",loading:this.state.loading,onClick:this.handleReCheck,children:"\u91cd\u65b0\u68c0\u6d4b"})}),Object(h.jsx)("div",{style:{marginTop:"1rem"},children:Object(h.jsx)("a",{href:"https://www.yuque.com/chuyi-ble7p/beancount-ns/sqwwqa#RwqnF",target:"_blank",children:"\u600e\u4e48\u5b89\u88c5 beancount ?"})})]}):"ok"===this.state.checkStatus?this.state.showForm?Object(h.jsx)("div",{children:Object(h.jsxs)(r.a,{name:"init-form",className:"page-form",size:"middle",layout:"vertical",style:{textAlign:"left"},ref:this.formRef,onFinish:this.handleSubmitServerConfig,validateMessages:j,children:[Object(h.jsx)(r.a.Item,{label:Object(h.jsxs)(d.Fragment,{children:[Object(h.jsx)("span",{children:"\u8d26\u672c\u5b58\u50a8\u4f4d\u7f6e"}),"\xa0",Object(h.jsx)(i.a,{title:"\u5982\u679c\u662fdocker\u5bb9\u5668\u90e8\u7f72\uff0c\u6b64\u5904\u9ed8\u8ba4\u4e3a\uff1a/data/beancount",children:Object(h.jsx)(u.a,{})})]}),name:"dataPath",initialValue:this.state.config.dataPath,rules:[{required:!0}],children:Object(h.jsx)(o.a,{placeholder:"\u8d26\u672c\u5b58\u50a8\u4f4d\u7f6e"})}),Object(h.jsx)(r.a.Item,{label:"\u8d26\u672c\u5f00\u59cb\u65e5\u671f",name:"startDate",initialValue:this.state.config.startDate,rules:[{required:!0}],children:Object(h.jsx)(o.a,{type:"date",placeholder:"\u8d26\u672c\u5f00\u59cb\u65e5\u671f"})}),Object(h.jsx)(r.a.Item,{label:"\u5e01\u79cd",name:"operatingCurrency",initialValue:this.state.config.operatingCurrency,rules:[{required:!0}],children:Object(h.jsx)(o.a,{placeholder:"\u5e01\u79cd"})}),Object(h.jsx)(r.a.Item,{label:"\u5e73\u8861\u8d26\u6237\u540d\u79f0\u8bbe\u7f6e",name:"openingBalances",initialValue:this.state.config.openingBalances,rules:[{required:!0}],children:Object(h.jsx)(o.a,{placeholder:"\u5e73\u8861\u8d26\u6237\u540d\u79f0\u8bbe\u7f6e"})}),Object(h.jsx)(r.a.Item,{label:"\u4fee\u6539\u6e90\u6587\u4ef6\u65f6\u662f\u5426\u5907\u4efd\u6570\u636e",name:"isBak",valuePropName:"checked",initialValue:this.state.config.isBak,children:Object(h.jsx)(s.a,{})}),Object(h.jsx)(r.a.Item,{label:Object(h.jsxs)(d.Fragment,{children:[Object(h.jsx)("span",{children:"\u5bc6\u94a5"}),"\xa0",Object(h.jsx)(i.a,{title:"\u53ef\u4ee5\u5728\u542f\u52a8\u65e5\u5fd7\u4e2d\u67e5\u770b",children:Object(h.jsx)(u.a,{})})]}),name:"secret",rules:[{required:!0}],children:Object(h.jsx)(o.a.Password,{placeholder:"\u5bc6\u94a5"})}),Object(h.jsx)(r.a.Item,{children:Object(h.jsx)(c.a,{block:!0,type:"primary",htmlType:"submit",loading:this.state.loading,className:"submit-button",children:"\u786e\u8ba4"})})]})}):Object(h.jsxs)("div",{children:[Object(h.jsx)(a.a,{message:"\u68c0\u6d4b\u901a\u8fc7",description:"beancount\u5df2\u5b89\u88c5\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6765\u5b8c\u6210\u521d\u59cb\u914d\u7f6e",type:"success",showIcon:!0}),Object(h.jsx)("div",{style:{marginTop:"1rem"}}),Object(h.jsx)(c.a,{type:"primary",block:!0,onClick:this.handleNextStep,children:"\u4e0b\u4e00\u6b65"})]}):Object(h.jsx)(l.a,{tip:"Loading...",children:Object(h.jsx)(a.a,{message:"\u68c0\u6d4b\u4e2d",description:"\u6b63\u5728\u68c0\u6d4b beancount \u662f\u5426\u5df2\u5b89\u88c5",type:"info",showIcon:!0})})}}O.contextType=p.a,t.default=Object(b.a)(O)}}]);
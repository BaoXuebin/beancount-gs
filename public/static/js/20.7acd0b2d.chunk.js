(this["webpackJsonpbeancount-web"]=this["webpackJsonpbeancount-web"]||[]).push([[20],{188:function(t,e,i){"use strict";var n=i(0),s=i(5);e.a=t=>class extends n.Component{constructor(){super(...arguments),this.defaultCommodity={currency:"CNY",symbol:"\uffe5"},this.currentCommodity=window.localStorage.getItem("ledgerCurrency")}render(){return Object(s.jsx)(t,{...this.props,commodity:this.currentCommodity?JSON.parse(this.currentCommodity):this.defaultCommodity})}}},456:function(t,e,i){"use strict";i.r(e);var n=i(470),s=i(32),a=i(225),h=i(61),o=i(341),c=(i(437),i(0)),r=i(91),d=i(73),l=i(188),p=i(5);class m extends c.Component{constructor(){super(...arguments),this.theme=this.context.theme,this.state={loading:!1,path:null,files:[],rawContent:"",content:"",editorState:o.EditorState.createEmpty()},this.fetchFileDir=()=>{this.setState({loading:!0}),Object(r.d)("/api/auth/file/dir").then((t=>{this.setState({files:t})})).finally((()=>{this.setState({loading:!1})}))},this.handldEditContent=t=>{this.setState({editorState:t,content:t.getCurrentContent().getPlainText()})},this.handleChangeFile=t=>{this.setState({path:t},(()=>{this.fetchFileContent(t)}))},this.fetchFileContent=()=>{this.setState({loading:!0}),Object(r.d)(`/api/auth/file/content?path=${this.state.path}`).then((t=>{this.setState({rawContent:t,content:t,editorState:o.EditorState.createWithContent(o.ContentState.createFromText(t))})})).finally((()=>{this.setState({loading:!1})}))},this.saveFileContent=()=>{const{path:t,content:e}=this.state;this.setState({loading:!0}),Object(r.d)("/api/auth/file",{method:"POST",body:{path:t,content:e}}).then((()=>{this.setState({rawContent:e}),s.b.success("\u4fdd\u5b58\u6210\u529f")})).finally((()=>{this.setState({loading:!1})}))}}componentDidMount(){this.fetchFileDir()}render(){return this.context.theme!==this.theme&&(this.theme=this.context.theme),Object(p.jsxs)("div",{className:"edit-page",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)(a.a,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6e90\u6587\u4ef6",style:{width:"200px"},onChange:this.handleChangeFile,children:this.state.files.map((t=>Object(p.jsx)(a.a.Option,{value:t,children:t},t)))}),"\xa0\xa0",Object(p.jsx)(h.a,{type:"primary",icon:Object(p.jsx)(n.a,{}),disabled:this.state.rawContent===this.state.content||!this.state.path,loading:this.state.loading,onClick:this.saveFileContent,children:"\u4fdd\u5b58"})]}),Object(p.jsx)("div",{style:{marginTop:"1rem"},children:Object(p.jsx)(o.Editor,{placeholder:this.state.path?"\u8be5\u6587\u4ef6\u5185\u5bb9\u4e3a\u7a7a":"\u672a\u9009\u62e9\u6e90\u6587\u4ef6",editorState:this.state.editorState,onChange:this.handldEditContent})})]})}}m.contextType=d.a,e.default=Object(l.a)(m)}}]);